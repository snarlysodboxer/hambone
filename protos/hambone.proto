syntax = "proto3";

package hambone;

import "vendor/annotations.proto";

service SpecGroups {
    rpc Create(CreateSpecGroupRequest) returns (CreateSpecGroupResponse) {
        option (google.api.http) = {
            post: "/v1/specgroup"
            body: "*"
        };
    }
    rpc Read(ReadSpecGroupRequest) returns (ReadSpecGroupResponse) {
        option (google.api.http) = {
            get: "/v1/specgroup/{name}"
        };
    }
}

message Empty {}

message SpecGroup {
    string name = 1;
    repeated Spec specs = 2;
}

message Spec {
    string name = 1;
    string template = 2;
}

message CreateSpecGroupRequest {
    SpecGroup spec_group = 1;
}

message CreateSpecGroupResponse {
    string name = 1;
}

message ReadSpecGroupRequest {
    string name = 1;
}

message ReadSpecGroupResponse {
    SpecGroup spec_group = 1;
}


service Instances {
    rpc Create(CreateInstanceRequest) returns (CreateInstanceResponse) {
        option (google.api.http) = {
            post: "/v1/instance"
            body: "*"
        };
    }
    rpc Read(ReadInstanceRequest) returns (ReadInstanceResponse) {
        option (google.api.http) = {
            get: "/v1/instance/{name}"
        };
    }
    // TODO
    // rpc Render(RenderRequest) returns (RenderResponse) {
    //     option (google.api.http) = {
    //         get: "/v1/instance/render{name}"
    //     };
    // }
    // rpc Status(StatusRequest) returns (StatusResponse) {
    //     option (google.api.http) = {
    //         get: "/v1/instance/status/{name}"
    //     };
    // }
}

message Instance {
    string name = 1;
    string spec_group_name = 2;
    repeated ValueSet value_sets = 3;
}

message ValueSet {
    string spec_name = 1;
    string json_blob = 2;
}

message CreateInstanceRequest {
    Instance instance = 1;
}

message CreateInstanceResponse {
    string name = 1;
}

message ReadInstanceRequest {
    string name = 1;
}

message ReadInstanceResponse {
    Instance instance = 1;
}

