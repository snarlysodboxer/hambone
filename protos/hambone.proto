syntax = "proto3";

package hambone;

import "vendor/annotations.proto";

service SpecGroups {
    rpc Create(CreateSpecGroupRequest) returns (CreateSpecGroupResponse) {
        option (google.api.http) = {
            post: "/v1/specgroup"
            body: "*"
        };
    }
    rpc Read(ReadSpecGroupRequest) returns (ReadSpecGroupResponse) {
        option (google.api.http) = {
            get: "/v1/specgroup/{id}"
        };
    }
}

message Empty {}

message SpecGroup {
    int32 id = 1;
    string name = 2;
    repeated Spec specs = 3;
}

message Spec {
    int32 id = 1;
    string name = 2;
    string template = 3;
}

message CreateSpecGroupRequest {
    SpecGroup spec_group = 1;
}

message CreateSpecGroupResponse {
    int32 id = 1;
}

message ReadSpecGroupRequest {
    int32 id = 1;
}

message ReadSpecGroupResponse {
    SpecGroup spec_group = 1;
}


service Instances {
    rpc Create(CreateInstanceRequest) returns (CreateInstanceResponse) {
        option (google.api.http) = {
            post: "/v1/instance"
            body: "*"
        };
    }
    rpc Read(ReadInstanceRequest) returns (ReadInstanceResponse) {
        option (google.api.http) = {
            get: "/v1/instance/{id}"
        };
    }
}

message Instance {
    int32 id = 1;
    string name = 2;
    int32 spec_group_id = 3;
    repeated ValueSet value_sets = 4;
}

message ValueSet {
    int32 spec_id = 1;
    string json_blob = 2;
}

message CreateInstanceRequest {
    Instance instance = 1;
}

message CreateInstanceResponse {
    int32 id = 1;
}

message ReadInstanceRequest {
    int32 id = 1;
}

message ReadInstanceResponse {
    Instance instance = 1;
}

